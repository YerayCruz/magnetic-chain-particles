# 3D LJ simulation of a binary mixture with Langevin thermostat

dimension       3
boundary        p p p
atom_style      hybrid sphere paramagnet angle

pair_style hybrid lj/cut/dipole/cut 1 20
bond_style	fene
angle_style 	harmonic
#dihedral_style	harmonic

units micro

read_data 	test.lmpdata

neighbor        2.0 bin
neigh_modify    delay 5

group Atoms type 1

## magnetic field
variable Bmag atom 2.6614538978577816e-05
variable freq atom 3.0
variable theta atom 1.5707963267948966
variable phi atom 0.0

variable fieldx atom v_Bmag*cos(v_freq*time*2*PI+v_phi)*sin(v_theta)
variable fieldy atom v_Bmag*sin(v_freq*time*2*PI+v_phi)*sin(v_theta)
variable fieldz atom v_Bmag*cos(v_theta)

fix 1 Atoms setdipole v_fieldx v_fieldy v_fieldz 0
fix 2 Atoms bd 300 0.001 56670
fix 3 Atoms addforce 0 0.0 -0.0
#fix 6 Atoms wall/lj126 zlo EDGE 0.01 1.247258205396475  1.4 zhi EDGE 0.01 1.247258205396475  1.4

compute erot all erotate/sphere
thermo_style custom step temp epair c_erot etotal press
dump 1 all custom 1 dump.polymer id type x y z mux muy muz
#thermo_style custom v_fieldx_s

#minimize 1e-25 1e-25 500000 1000000

timestep        10 #Si el timestep es de 100.0 se rompe diciendo que el fene bond is too long
thermo          100

#dump 2 all atom 100 dump.polymer

run 60000
